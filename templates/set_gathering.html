{% extends "base.html" %}
{% block title %}Set Gathering{% endblock %}
{% block content %}
<h1>Set Gathering Skills</h1>

<form id="gatheringForm">
  <div class="skills-container">
    <div class="skill">
      <label>Mercantile:</label>
      <select id="mercantile" name="mercantile">
        {% for i in range(5) %}
          <option value="{{ i }}">{{ i }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="skill">
      <label>Black Market:</label>
      <select id="black_market" name="black_market">
        {% for i in range(5) %}
          <option value="{{ i }}">{{ i }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="skill">
      <label>Hunting:</label>
      <select id="hunting" name="hunting">
        {% for i in range(5) %}
          <option value="{{ i }}">{{ i }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="skill">
      <label>Mining:</label>
      <select id="mining" name="mining">
        {% for i in range(5) %}
          <option value="{{ i }}">{{ i }}</option>
        {% endfor %}
      </select>
    </div>
    <div class="skill">
      <label>Cargo Ship:</label>
      <select id="cargo_ship" name="cargo_ship">
        {% for i in range(5) %}
          <option value="{{ i }}">{{ i }}</option>
        {% endfor %}
      </select>
    </div>
  </div>

  <button type="button" onclick="submitGathering()">Submit</button>
</form>

<script>
async function submitGathering() {
  const character_data={
    mercantile:document.getElementById("mercantile").value,
    black_market:document.getElementById("black_market").value,
    hunting:document.getElementById("hunting").value,
    mining:document.getElementById("mining").value,
    cargo_ship:document.getElementById("cargo_ship").value
  }

  const response=await fetch("/submit_gathering",{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      selected_items:JSON.parse(localStorage.getItem("selected_items")||"[]"),
      character_data:character_data
    })
  })

  if(response.redirected){
    window.location.href=response.url
  }
}
</script>

<style>
.skills-container {
  display: flex;
  flex-wrap: wrap;
  gap: 1rem;
}
.skill {
  display: flex;
  flex-direction: column;
  align-items: start;
}
</style>
{% endblock %}
